<!DOCTYPE html>
<html lang='en'>
<head>
    <meta charset='UTF-8'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0'>
    <title>AWS VPN Clients</title>
<script>
    async function fetchClients() {
        const response = await fetch('/api/clients');
        const data = await response.json();

        const filterValue = document.getElementById('filterInput').value.toLowerCase();
        const tbody = document.getElementById('clientsBody');
        tbody.innerHTML = '';

        data.forEach(client => {
            if (
                client.username.toLowerCase().includes(filterValue) ||
                client.ip.includes(filterValue)
            ) {
                const row = document.createElement('tr');
                [
                    client.username,
                    client.ip,
                    client.connection_id,
                    client.status,
                    client.timestamp,
                    client.ingress_data,
                    client.egress_data
                ].forEach(value => {
                    const cell = document.createElement('td');
                    cell.textContent = value;
                    row.appendChild(cell);
                });
                tbody.appendChild(row);
            }
        });
    }


    window.onload = fetchClients;
    setInterval(fetchClients, 50000);
    document.getElementById('filterInput').addEventListener('input', fetchClients);

</script>

    <style>
            body {
                font-family: Arial, sans-serif;
                background-color: #f4f4f9;
                padding: 20px;
            }
            table {
                width: 100%;
                border-collapse: collapse;
                margin-top: 20px;
            }
            table, th, td {
                border: 1px solid #ccc;
            }
            th, td {
                padding: 12px;
                text-align: left;
            }
            th {
                background-color: #4CAF50;
                color: white;
            }
            tr:nth-child(even) {
                background-color: #f2f2f2;
            }
        </style>
</head>
<body>
<h1>AWS VPN Connected Clients</h1>
<input type="text" id="filterInput" placeholder="Filtrer par nom ou IP" onkeyup='fetchClients()'>
<table id="clientsTable" border="1">
    <thead>
        <tr>
            <th>Username</th>
            <th>IP</th>
            <th>Connection ID</th>
            <th>Status</th>
            <th>Connection Start Time</th>
            <th>Ingress Data (bytes)</th>
            <th>Egress Data (bytes)</th>
        </tr>
    </thead>
    <tbody id="clientsBody"></tbody>
</table>
</body>
</html>
